# üìö Kilian Siebert Portfolio - Vollst√§ndige Dokumentation

Diese Dokumentation enth√§lt detaillierte Informationen zur Setup, Konfiguration und Verwendung der Portfolio-Website.

## üìã Inhaltsverzeichnis

- [Vollst√§ndige Setup-Anleitung](#-vollst√§ndige-setup-anleitung)
- [Environment-Konfiguration](#-environment-konfiguration)
- [Datenbank-Management](#-datenbank-management)
- [Admin-Dashboard](#-admin-dashboard)
- [Kontaktformular & Anfrage-Management](#-kontaktformular--anfrage-management)
- [E-Mail-Konfiguration](#-e-mail-konfiguration)
- [API-Dokumentation](#-api-dokumentation)
- [Projekt-Architektur](#-projekt-architektur)
- [Konfiguration](#-konfiguration)
- [Troubleshooting](#-troubleshooting)
- [Deployment](#-deployment)

## üèó Vollst√§ndige Setup-Anleitung

### 1. Repository klonen
```bash
git clone <repository-url>
cd PortfolioWebapp
```

### 2. Dependencies installieren
```bash
npm install
```

### 3. Environment-Konfiguration
Erstelle eine `.env.local` Datei im Root-Verzeichnis:

```env
# Database
DATABASE_URL="file:./dev.db"

# NextAuth Configuration
NEXTAUTH_URL="http://localhost:3000"
NEXTAUTH_SECRET="your-secret-key-here"

# Admin Configuration
ADMIN_EMAIL="mhiller2005@gmail.com"
ADMIN_PASSWORD_HASH="bcrypt-hashed-password"

# Email Configuration (Optional - f√ºr Kontaktformular-Benachrichtigungen)
SMTP_HOST="smtp.gmail.com"
SMTP_PORT="587"
SMTP_SECURE="false"
SMTP_USER="your-email@gmail.com"
SMTP_PASSWORD="your-app-password"
EMAIL_FROM="your-email@gmail.com"
```

### 4. Datenbank-Setup
```bash
# Prisma Client generieren
npx prisma generate

# Datenbank-Migrationen ausf√ºhren
npm run db:migrate

# Datenbank mit Beispieldaten f√ºllen
npm run db:seed
```

### 5. Admin-Benutzer einrichten
```bash
# Admin-Benutzer-Passwort einrichten
npm run setup:admin
```

### 6. Entwicklungsserver starten
```bash
npm run dev
```

Die Anwendung ist verf√ºgbar unter [http://localhost:3000](http://localhost:3000)

## üõ†Ô∏è Environment-Konfiguration

### Basis-Konfiguration
```env
# NextAuth
NEXTAUTH_URL="http://localhost:3000"
NEXTAUTH_SECRET="generiere-einen-sicheren-schl√ºssel"

# Admin
ADMIN_EMAIL="admin@example.com"
ADMIN_PASSWORD_HASH="$2b$12$..."  # Wird durch setup:admin gesetzt
```

### E-Mail-Konfiguration (Optional)

#### Option A: Gmail SMTP
```env
ADMIN_EMAIL="mhiller2005@gmail.com"
SMTP_HOST="smtp.gmail.com"
SMTP_PORT="587"
SMTP_SECURE="false"
SMTP_USER="your-email@gmail.com"
SMTP_PASSWORD="your-app-password"  # App-Passwort verwenden!
EMAIL_FROM="your-email@gmail.com"
```

#### Option B: SendGrid
```env
ADMIN_EMAIL="mhiller2005@gmail.com"
SMTP_HOST="smtp.sendgrid.net"
SMTP_PORT="587"
SMTP_SECURE="false"
SMTP_USER="apikey"
SMTP_PASSWORD="your-sendgrid-api-key"
EMAIL_FROM="your-verified-sender@domain.com"
```

#### Option C: Custom SMTP
```env
ADMIN_EMAIL="mhiller2005@gmail.com"
SMTP_HOST="mail.your-domain.com"
SMTP_PORT="587"
SMTP_SECURE="false"
SMTP_USER="your-smtp-user"
SMTP_PASSWORD="your-smtp-password"
EMAIL_FROM="noreply@your-domain.com"
```

## üóÑÔ∏è Datenbank-Management

### Verf√ºgbare Commands
```bash
npm run db:push      # Schema-√Ñnderungen zur Datenbank pushen
npm run db:migrate   # Migrationen erstellen und ausf√ºhren
npm run db:seed      # Datenbank mit Beispieldaten f√ºllen
npm run db:studio    # Prisma Studio GUI √∂ffnen
npm run db:reset     # Datenbank komplett zur√ºcksetzen
```

### Datenbank zur√ºcksetzen und neu bef√ºllen
```bash
# Methode 1: Komplett zur√ºcksetzen (empfohlen)
npm run db:reset

# Methode 2: Manuelle Schritte
npx prisma db push --force-reset  # Datenbank zur√ºcksetzen
npm run db:seed                   # Mock-Daten laden
```

Dies wird:
1. Alle existierenden Daten l√∂schen
2. Datenbank-Schema neu erstellen
3. Beispiel-Portfolio-Items, Kategorien und Benutzerdaten laden

### Datenbank-Schema

#### Kern-Modelle
- **User** - Authentifizierung mit Rollen (VISITOR, REGISTERED, ADMIN)
- **PortfolioItem** - Medien-Items mit Metadaten, Kategorien, Tags, View-Counts
- **Category** - Portfolio-Kategorisierung (Nature, Travel, Events, Videography)
- **Inquiry** - Kontaktformular-Einreichungen mit Status-Tracking
- **NewsletterSubscriber** - E-Mail-Abonnements
- **AnalyticsEvent** - Basis-Analytics-Tracking

#### Content-Workflow
Portfolio-Items folgen einem strukturierten Workflow:
- **DRAFT** - Work in Progress
- **REVIEW** - Bereit zur √úberpr√ºfung
- **PUBLISHED** - Live auf der Website
- **ARCHIVED** - Vor der √ñffentlichkeit verborgen

## üõ†Ô∏è Admin-Dashboard

### Zugang zum Dashboard
```
http://localhost:3000/admin/inquiries
```

### Vollst√§ndige Portfolio-Verwaltung:
- Portfolio-Items erstellen, bearbeiten, l√∂schen
- Kategorie-Management
- File-Upload mit Vorschau
- Status-Management
- **Anfrage-Management** - Kunden-Kontakt-Anfragen bearbeiten
- Analytics-√úbersicht

### Authentifizierung & Autorisierung
- JWT-Tokens mit HTTP-only Cookies (24-Stunden-Ablauf)
- bcrypt f√ºr Passwort-Hashing
- Rollenbasierter Zugang: ADMIN-Rolle erforderlich f√ºr `/admin/*` Routen
- Gesch√ºtzt durch Middleware in `src/middleware.ts`
- Umfassendes Sicherheits-Logging via winston

### Schl√ºssel-Komponenten
- **PortfolioGrid** (`src/components/gallery/`): Infinite Scroll Galerie mit Masonry/Grid-Toggle
- **Lightbox** (`src/components/gallery/`): Vollbild-Bild-Viewer mit Tastatur-Navigation
- **AdminDashboard** (`src/app/(admin)/admin/`): Portfolio-Management-Interface
- **AuthProvider** (`src/components/providers/`): Session-Management-Wrapper

### State-Management
- Zustand Store in `src/store/portfolio-store.ts` f√ºr Portfolio-State
- Client-seitiges Caching und Pagination
- Optimistische Updates f√ºr View-Counts
- Lightbox State-Management mit Tastatur-Navigation

## üì¨ Kontaktformular & Anfrage-Management-System

Das Portfolio beinhaltet ein umfassendes Kontaktformular und Anfrage-Management-System f√ºr professionelle Kunden-Kommunikation.

### üåü Features-√úbersicht

#### **Kunden-seitiges Kontaktformular**
- **Professionelles Form-Design** - Sauberes, responsives Formular mit Validierung
- **Service-Kategorien** - Nature, Travel, Event, Videography Optionen
- **GDPR-Konformit√§t** - Erforderliches Datenschutz-Einverst√§ndnis-Checkbox
- **Echtzeit-Validierung** - Client- und serverseitige Validierung mit Zod
- **Benutzer-Feedback** - Erfolg/Fehler-Nachrichten mit professionellem Styling
- **Spam-Schutz** - Eingebaute Spam-Erkennung und Rate-Limiting

#### **Admin Anfrage-Management Dashboard**
- **Zentralisiertes Dashboard** - Alle Anfragen anzeigen unter `/admin/inquiries`
- **Echtzeit-Statistiken** - Anzahl neuer, laufender und gel√∂ster Anfragen
- **Erweiterte Filterung** - Suche nach Name, E-Mail oder Betreff
- **Status-Management** - Anfrage-Status aktualisieren (NEW ‚Üí IN_PROGRESS ‚Üí RESOLVED ‚Üí CLOSED)
- **Schnelles Antwort-System** - Professionelle Antworten direkt vom Dashboard senden
- **Detailansicht** - Vollst√§ndige Anfrage-Details mit Kunden-Kontaktinformationen

#### **E-Mail-System**
- **Doppelte Benachrichtigungen** - Admin-Warnungen + Kunden-Best√§tigungen
- **Professionelle Templates** - HTML-E-Mail-Templates mit Branding
- **Auto-Antworten** - Sofortige Best√§tigungs-E-Mails an Kunden
- **Individuelle Antworten** - Personalisierte Antworten vom Admin-Dashboard
- **Entwicklungsmodus** - E-Mail-Simulation ohne SMTP-Konfiguration

### üõ† Setup-Anweisungen

#### **1. Basis-Setup (Funktioniert sofort)**
Das Kontaktformular funktioniert out-of-the-box mit E-Mail-Simulation:

```bash
# Keine zus√§tzliche Einrichtung erforderlich - E-Mails werden in der Konsole protokolliert
npm run dev
# Besuche http://localhost:3000/contact zum Testen
```

#### **2. Produktions-E-Mail-Setup**
F√ºr Live-E-Mail-Benachrichtigungen konfiguriere SMTP in `.env.local` (siehe E-Mail-Konfiguration oben).

### üìß Gmail App-Passwort Setup

Um Gmail SMTP zu verwenden, ben√∂tigst du ein App-Passwort (nicht dein regul√§res Passwort):

1. **2-Faktor-Authentifizierung aktivieren** auf deinem Google-Konto
2. **App-Passwort generieren**:
   - Gehe zu Google-Konto-Einstellungen
   - Sicherheit ‚Üí 2-Schritt-Verifizierung ‚Üí App-Passw√∂rter
   - App ausw√§hlen: "Mail" und Ger√§t: "Andere (Benutzerdefinierter Name)"
   - Das 16-stellige Passwort kopieren
3. **In .env.local verwenden**:
   ```env
   SMTP_PASSWORD="dein-16-stelliges-app-passwort"
   ```

### üéØ Kunden-Journey

1. **Kunde** besucht `/contact` Seite
2. **F√ºllt Formular aus** mit Projekt-Details und Service-Kategorie
3. **Formular-Validierung** stellt sicher, dass alle erforderlichen Felder ausgef√ºllt sind
4. **Einreichung** speichert Anfrage in Datenbank und l√∂st E-Mails aus:
   - **Admin-Benachrichtigung** gesendet an `ADMIN_EMAIL`
   - **Kunden-Best√§tigung** gesendet mit Referenz-ID
5. **Admin** erh√§lt E-Mail-Benachrichtigung und kann:
   - Anfrage im Dashboard unter `/admin/inquiries` anzeigen
   - Status und Priorit√§t aktualisieren
   - Personalisierte Antwort senden
6. **Status-Tracking** w√§hrend des gesamten Prozesses

### üîß Admin Anfrage-Management

#### **Dashboard zugreifen**
```
http://localhost:3000/admin/inquiries
```

#### **Schl√ºssel-Features**
- **Statistik-Karten** - √úbersicht der Anfrage-Anzahl nach Status
- **Suchen & Filtern** - Anfragen nach Name, E-Mail oder Betreff finden
- **Status-Updates** - Klicken um Anfrage-Status zu √§ndern
- **Detail-Panel** - Anfrage anklicken um vollst√§ndige Details anzuzeigen
- **Schnelle Antwort** - Antworten direkt vom Dashboard senden
- **Kontakt-Integration** - Direkte E-Mail- und Telefon-Links

#### **Anfrage-Workflow**
```
NEW ‚Üí IN_PROGRESS ‚Üí RESOLVED ‚Üí CLOSED
```

- **NEW**: Frische Anfrage, ben√∂tigt Aufmerksamkeit
- **IN_PROGRESS**: Wird gerade bearbeitet
- **RESOLVED**: Antwort an Kunde gesendet
- **CLOSED**: Anfrage abgeschlossen/archiviert

### üõ° Sicherheits-Features

- **Rate-Limiting** - Max. 5 Einreichungen pro Stunde pro IP
- **Spam-Erkennung** - Automatische Bewertung basierend auf Inhalts-Mustern
- **Input-Validierung** - Serverseitige Validierung mit Zod-Schemas
- **GDPR-Konformit√§t** - Erforderliches Datenschutz-Einverst√§ndnis
- **Umfassendes Logging** - Alle Aktionen mit Winston protokolliert
- **CSRF-Schutz** - Eingebauter Next.js CSRF-Schutz

### üß™ System testen

#### **Manuelles Testen**
1. Entwicklungsserver starten: `npm run dev`
2. Kontaktformular besuchen: `http://localhost:3000/contact`
3. Formular ausf√ºllen und absenden
4. Server-Konsole f√ºr E-Mail-Logs pr√ºfen
5. Admin-Dashboard besuchen: `http://localhost:3000/admin/inquiries`
6. Antwort-Funktionalit√§t testen

#### **Entwicklung vs. Produktion**
- **Entwicklung**: E-Mails simuliert und in Konsole protokolliert
- **Produktion**: Echte E-Mails √ºber konfiguriertes SMTP gesendet

## üìä API-Dokumentation

### √ñffentliche API-Endpoints
- `GET /api/portfolio` - Ver√∂ffentlichte Portfolio-Items abrufen
- `GET /api/portfolio/[id]` - Einzelnes Portfolio-Item abrufen
- `GET /api/categories` - Kategorien abrufen
- `POST /api/contact` - Kontaktformular absenden (mit E-Mail-Benachrichtigungen)

### Admin API-Endpoints

#### Portfolio-Management
- `GET /api/admin/portfolio` - Alle Portfolio-Items abrufen (beliebiger Status)
- `GET /api/admin/portfolio/[id]` - Einzelnes Item zum Bearbeiten abrufen
- `PUT /api/admin/portfolio/[id]` - Portfolio-Item aktualisieren
- `POST /api/portfolio` - Neues Portfolio-Item erstellen
- `POST /api/upload` - Dateien hochladen und verarbeiten

#### Anfrage-Management
- `GET /api/admin/inquiries` - Alle Kunden-Anfragen abrufen
- `PATCH /api/admin/inquiries/[id]` - Anfrage-Status/Priorit√§t aktualisieren
- `POST /api/admin/inquiries/[id]/reply` - Individuelle Antwort an Kunden senden

## üèó Projekt-Architektur

### Datei-Struktur
```
src/
‚îú‚îÄ‚îÄ app/                    # Next.js App Router-Seiten
‚îÇ   ‚îú‚îÄ‚îÄ (admin)/           # Admin-gesch√ºtzte Routen
‚îÇ   ‚îú‚îÄ‚îÄ (auth)/            # Authentifizierungs-Seiten
‚îÇ   ‚îú‚îÄ‚îÄ api/               # API-Routen
‚îÇ   ‚îî‚îÄ‚îÄ globals.css        # Globale Styles
‚îú‚îÄ‚îÄ components/            # Wiederverwendbare Komponenten
‚îÇ   ‚îú‚îÄ‚îÄ gallery/          # Portfolio-Galerie-Komponenten
‚îÇ   ‚îú‚îÄ‚îÄ ui/               # UI-Komponenten (shadcn/ui)
‚îÇ   ‚îî‚îÄ‚îÄ providers/        # Context-Provider
‚îú‚îÄ‚îÄ lib/                  # Utilities und Konfigurationen
‚îÇ   ‚îú‚îÄ‚îÄ db.ts            # Datenbank-Client
‚îÇ   ‚îú‚îÄ‚îÄ auth.ts          # Authentifizierungs-Konfiguration
‚îÇ   ‚îú‚îÄ‚îÄ storage.ts       # Dateispeicher-Utilities
‚îÇ   ‚îî‚îÄ‚îÄ image-processor.ts # Bildverarbeitung
‚îú‚îÄ‚îÄ store/               # Zustand State-Management
‚îî‚îÄ‚îÄ types/              # TypeScript-Typdefinitionen

prisma/
‚îú‚îÄ‚îÄ schema.prisma       # Datenbank-Schema
‚îú‚îÄ‚îÄ dev.db             # SQLite-Datenbankdatei
‚îî‚îÄ‚îÄ seed.ts            # Datenbank-Seeding-Skript

public/
‚îú‚îÄ‚îÄ uploads/           # Benutzer-hochgeladene Dateien
‚îÇ   ‚îî‚îÄ‚îÄ portfolio/    # Portfolio-Mediendateien
‚îî‚îÄ‚îÄ images/           # Statische Bilder
```

### Datenbank-Beziehungen
- Portfolio-Items geh√∂ren zu Kategorien
- Portfolio-Items haben Metadaten (Fotograf, Ort, Kamera-Einstellungen)
- Benutzer k√∂nnen mehrere Rollen haben und Inhalte verwalten

## üîß Konfiguration

### Bildverarbeitung
Bildverarbeitungsoptionen in `src/lib/image-processor.ts` konfigurieren:
```typescript
export const DEFAULT_PROCESSING_OPTIONS = {
  quality: 85,
  maxWidth: 2400,
  maxHeight: 2400,
  thumbnailSize: 400,
  generateWebP: true,
  generateAVIF: true,
}
```

### Speicher-Konfiguration
Speicher-Einstellungen in `src/lib/storage.ts` √§ndern:
```typescript
export const DEFAULT_STORAGE_CONFIG = {
  maxFileSize: 10 * 1024 * 1024, // 10MB
  allowedImageTypes: ['image/jpeg', 'image/png', 'image/webp'],
  allowedVideoTypes: ['video/mp4', 'video/quicktime'],
}
```

### File-Upload & Verarbeitung
- Automatische Bildoptimierung mit Sharp
- Generierung mehrerer Formate (WebP, AVIF)
- Thumbnail-Erstellung
- Datei-Validierung und Gr√∂√üenlimits
- Organisierte Speicher-Struktur

## üêõ Troubleshooting

### H√§ufige Probleme

#### **Formular wird nicht abgesendet:**
```bash
# Server-Logs f√ºr Validierungsfehler pr√ºfen
npm run dev
# Browser Network-Tab f√ºr API-Fehler pr√ºfen
```

#### **E-Mails werden nicht gesendet:**
```bash
# SMTP-Konfiguration in .env.local √ºberpr√ºfen
cat .env.local | grep SMTP

# SMTP-Verbindung testen (Server-Logs pr√ºfen)
# E-Mails werden auch bei SMTP-Fehlern protokolliert
```

#### **Admin-Dashboard l√§dt nicht:**
```bash
# Sicherstellen, dass Admin-Benutzer eingerichtet ist
npm run setup:admin

# Authentifizierung pr√ºfen
# Muss als ADMIN-Rolle angemeldet sein
```

### Datenbank-Probleme
```bash
# Wenn Prisma Client out of sync ist
npx prisma generate

# Bei Datenbank-Schema-Problemen
npx prisma db push --force-reset
npm run db:seed
```

### File-Upload-Probleme
```bash
# Upload-Verzeichnis-Berechtigungen pr√ºfen
ls -la public/uploads/

# Upload-Verzeichnisse neu erstellen
mkdir -p public/uploads/portfolio/{originals,thumbnails,webp,avif,temp}
```

### Admin-Zugriffs-Probleme
```bash
# Admin-Passwort zur√ºcksetzen
npm run setup:admin

# Environment-Variablen pr√ºfen
cat .env.local
```

## üöÄ Deployment

### Production-Build
```bash
npm run build
npm run start
```

### Environment-Variablen f√ºr Produktion
Stelle sicher, dass alle Environment-Variablen f√ºr Produktion richtig gesetzt sind:
- `NEXTAUTH_URL` - Deine Produktions-Domain
- `NEXTAUTH_SECRET` - Sicherer zuf√§lliger String
- `DATABASE_URL` - Produktions-Datenbank-Verbindung
- SMTP-Einstellungen f√ºr Kontaktformulare

### Dateispeicher
F√ºr Produktion erw√§gen:
- Cloud-Speicher verwenden (AWS S3, Cloudinary) statt lokaler Dateien
- CDN f√ºr Bild-Auslieferung
- Regelm√§√üige Backups des Uploads-Verzeichnisses

### E-Mail-Templates

Das System beinhaltet professionelle HTML-E-Mail-Templates:

- **Admin-Benachrichtigung**: Detaillierte Anfrage-Informationen mit schnellen Aktions-Links
- **Kunden-Best√§tigung**: Professionelle Best√§tigung mit n√§chsten Schritten
- **Individuelle Antwort**: Personalisierte Antwort-Template mit urspr√ºnglichem Anfrage-Kontext

Alle Templates sind mobile-responsive und beinhalten:
- Professionelles Branding
- Klare Typografie
- Aktions-Buttons
- Kontakt-Informationen
- Rechtliche Compliance-Texte

## üß™ Testing

### Verf√ºgbare Test-Commands
```bash
npm run test         # Tests ausf√ºhren
npm run test:watch   # Tests im Watch-Mode
npm run test:coverage # Tests mit Coverage-Report
```

### Testing-Framework
- Jest als Testing-Framework mit Coverage-Reporting
- Umfassende Test-Suites f√ºr API-Routen und Komponenten

## üìÑ Wichtige Entwicklungs-Hinweise

- Datenbankdatei: `prisma/dev.db` (SQLite)
- Admin-Zugangsdaten m√ºssen mit `npm run setup:admin` eingerichtet werden
- Bilder verwenden derzeit Unsplash-Platzhalter via `next.config.ts`
- TypeScript Strict-Mode aktiviert mit konfigurierten Pfad-Aliassen
- Tailwind CSS 4 mit individueller shadcn/ui Komponenten-Konfiguration
- Winston-Logging konfiguriert f√ºr Sicherheitsereignisse und Fehler
- Jest Testing-Framework mit Coverage-Reporting
- File-Uploads √ºber `/api/upload` Endpoint verarbeitet

---

**Letzte Aktualisierung:** Juli 2025  
**Version:** 1.0.0